<%= render partial: 'layouts/fancybox_bootstrap_fix' %>

<div id="blogs" class="content-section2">

  <% if @blogs %>

    <%= render partial: 'blog_header' %>

    <div id="blog-grid" class="grid">
      <%
        @blogs.each do |blog|
      %>
        <%= render partial: 'blogs/blog_card', locals: {blog: blog} %>
      <%
        end
      %>
    </div>

  <% else %>
    <div class="d-flex justify-content-center">
      <div class="media align-items-center mt-4 ml-5 mr-5">
        <% #TODO: I18n ME! %>
        Error displaying Blog.
      </div>
    </div>
  <% end %>

</div>

<script language="JavaScript">
    <% ((@page+=1)..@total_pages).each { |index| %>
    $.ajax({
        url: "<%= blog_load_page_path(page: index, category: @category_id) %>",
        dataType: "html",
        async: true,
        success: function (data) {
            var html = $(data);
            $('#blog-grid').append(html);
            $('#blog-grid').imagesLoaded( function() {
                $('.grid').masonry( 'appended', html ).layout();
            });
        }
    });
    <% } %>
</script>